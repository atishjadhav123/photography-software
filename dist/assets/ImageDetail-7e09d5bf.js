import{f as N,m as v,n as z,o as _,r as L,j as e,L as D,y as r}from"./index-67a0fc0a.js";import{a as P}from"./index-eeb3fb15.js";import{G as R}from"./iconBase-e20fe6c8.js";function k(l){return R({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M946.5 505L560.1 118.8l-25.9-25.9a31.5 31.5 0 0 0-44.4 0L77.5 505a63.9 63.9 0 0 0-18.8 46c.4 35.2 29.7 63.3 64.9 63.3h42.5V940h691.8V614.3h43.4c17.1 0 33.2-6.7 45.3-18.8a63.6 63.6 0 0 0 18.7-45.3c0-17-6.7-33.1-18.8-45.2zM568 868H456V664h112v204zm217.9-325.7V868H632V640c0-22.1-17.9-40-40-40H432c-22.1 0-40 17.9-40 40v228H238.1V542.3h-96l370-369.7 23.1 23.1L882 542.3h-96.1z"},child:[]}]})(l)}const H=()=>{const{id:l}=N(),{data:m,isLoading:p,error:i,isError:f}=v(l),[y,{isSuccess:I}]=z(),[j,{data:c,isSuccess:g}]=_(),[d,u]=L.useState(!1),s=m?m[0]:null,x=async(n,a)=>{try{const w=await(await fetch(n)).blob(),h=window.URL.createObjectURL(w),t=document.createElement("a");t.href=h,t.download=a||"image.jpg",document.body.appendChild(t),t.click(),document.body.removeChild(t),window.URL.revokeObjectURL(h),r.success("Download successful!")}catch(o){console.error("Download error:",o),r.error("Failed to download image. Please try again.")}},b=async()=>{if(s){u(!0);try{await j({amount:s.price}),g&&c&&new window.Razorpay({key:"rzp_test_z0YTRFCVCHn0bM",amount:c.result.amount,currency:"INR",order_id:c.result.id,prefill:{name:"John Doe",contact:"9876543210"},handler:async a=>{try{await y({razorpay_order_id:a.razorpay_order_id,razorpay_payment_id:a.razorpay_payment_id,razorpay_signature:a.razorpay_signature,userId:s==null?void 0:s._id,photoId:s==null?void 0:s._id,amount:s.price}),r.success("Payment successful!"),x(s.url,`${s.title}.jpg`)}catch(o){console.error("Transaction error:",o),r.error("Failed to record transaction.")}}}).open()}catch(n){console.error("Payment initialization error:",n),r.error("Failed to initialize payment.")}finally{u(!1)}}};return p?e.jsxs("div",{className:"flex justify-center items-center min-h-screen",children:[e.jsx("div",{className:"spinner-border text-blue-500",role:"status"}),e.jsx("h4",{children:"Loading image details..."})]}):f?e.jsx("div",{className:"text-center text-red-500",children:e.jsxs("h4",{children:["Error: ",(i==null?void 0:i.message)||"Unable to fetch image details"]})}):e.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center py-10",children:e.jsxs("div",{className:"container mx-auto bg-white rounded-lg shadow-xl overflow-hidden md:flex md:flex-row-reverse",children:[e.jsxs("div",{className:"md:w-1/2 relative",children:[e.jsx("img",{src:s.hero[0],alt:s.title,className:"w-full h-96 object-cover rounded-t-lg md:rounded-t-none md:rounded-l-lg shadow-lg"}),e.jsxs("div",{className:"absolute bottom-0 left-0 bg-black bg-opacity-50 text-white p-4 rounded-t-lg md:rounded-none",children:[e.jsx("p",{className:"font-semibold text-2xl",children:s.title}),e.jsx("p",{className:"text-sm",children:s.category})]})]}),e.jsxs("div",{className:"md:w-1/2 p-6 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:" flex justify-between",children:[e.jsx("h2",{className:"text-4xl font-extrabold text-gray-900 mb-4",children:s.title}),e.jsx(D,{to:"/",children:e.jsx(k,{className:" h-5 w-5"})})]}),e.jsx("p",{className:"text-gray-700 mb-6",children:s.description}),e.jsxs("ul",{className:"space-y-3 text-lg text-gray-600",children:[e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Category:"}),e.jsx("span",{children:s.category})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Price:"}),e.jsx("span",{children:s.price>0?`$${s.price}`:"Free"})]}),e.jsxs("li",{className:"flex justify-between",children:[e.jsx("span",{className:"font-semibold",children:"Resolution:"}),e.jsx("span",{children:s.resolution})]})]})]}),e.jsx("div",{className:"mt-6 flex items-center space-x-4",children:e.jsxs("button",{onClick:s.price>0?b:()=>x(s.url,`${s.title}.jpg`),className:`w-full flex items-center justify-center bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-opacity-50 ${d&&"opacity-50 cursor-not-allowed"}`,disabled:d,children:[e.jsx(P,{className:"h-7 w-7 mr-2 text-teal-400 animate-pulse"}),d?"Processing...":s.price>0?"Pay & Download":"Download"]})})]})]})})};export{H as default};
